{"version":3,"sources":["ui.js","login.js","game.js","core.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzDA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["/*\n  Update the welcome screen with information from friendCache.\n*/\nfunction renderWelcome() {\n    var welcome = $('#welcome');\n    welcome.find('.first_name').html(friendCache.me.first_name);\n    welcome.find('.profile').attr('src', friendCache.me.picture.data.url);\n    welcome.find('.stats .coins').html(Parse.User.current().get('coins'));\n    welcome.find('.stats .bombs').html(Parse.User.current().get('bombs'));\n}\n/*\n  Update scores of friends\n*/\nfunction renderPlaces(places) {\n    console.log('renderPLaces');\n    var list = $('#lugares');\n    var template = $('.template-lugar');\n    for (var i = 0; i < places.length; i++) {\n        var item = template.clone().removeClass('template-lugar').addClass('media');\n        item.attr('id', places[i].place_id);\n        item.find('a').attr('href',places[i].place_id);\n        item.find('.media-heading').html(places[i].name);\n        item.find('img').attr('src',(typeof places[i].photos !== \"undefined\")?places[i].photos[0].getUrl({'maxWidth': 50, 'maxHeight': 50}):places[i].icon);\n        item.find('img').attr('alt',places[i].name);\n        item.find('.vicinity').html(places[i].vicinity);\n        list.append(item);\n    }\n    $('#lugares .loading').fadeOut('fast');\n    $('#n_lugares').html(places.length);\n}\n\nfunction setBtnIniciar() {\n    var url = $('#btnIniciar').attr('base-url');\n    var provincia_id = $('#select_provincia').val();\n    var categoria_id = $('#select_categoria').val();\n    url += '/' + categoria_id + '/' + provincia_id;\n    $('#btnIniciar').attr('href', url);\n    $('#provincia_categoria_seleccionada').html(url);\n}\n\nfunction onChangeProvincia(e) {\n    e.preventDefault();\n    setBtnIniciar();\n}\n\nfunction onChangeCategoria(e) {\n    e.preventDefault();\n    setBtnIniciar();\n}\n\nfunction onListPlaceClick(e){\n    e.preventDefault();\n    if($(this).hasClass('local')){\n    \tget_info($(this).attr('href'));\n    }else{\n        detail_info($(this).attr('href'));\n    }\n}","","$('#btn_lugares').on('click',function(e){\n    $('#tabs a[href=\"#lugares\"]').tab('show');\n});\n\n\n$('button.visitado').on('click',function(e){\n    e.preventDefault();\n    var res = confirm('Conoces este lugar?');\n    if(res){\n        mark_place($(this).attr('place'));\n    }else{\n        alert('viaja mas');\n    }\n});\n\nfunction mark_place(place_id){\n    $.post('{{ url(\"visited\") }}',{'place_id':place_id,'user_id':1,_token: '{{ Session::token() }}'},function(response){\n        console.log(response);\n    });\n}\n\nfunction get_info(place_id){\n    $.get('{{ url(\"loader\") }}/'+place_id,function(response){\n        console.log('response');\n        console.log(response);\n        $('#tabs a[href=\"#detail\"]').tab('show');\n        var categorias =[];\n        var el = build_detail_from_server(response);\n        $('#detail').html(el);\n        $('button.visitado').on('click',function(e){\n            e.preventDefault();\n            var res = confirm('Conoces este lugar?');\n            if(res){\n                mark_place($(this).attr('place'));\n            }else{\n                alert('viaja mas');\n            }\n        });\n    },'json');\n}\n\nvar map;\nvar infoWindow\nfunction initMap() {\n    console.log('initMap');\n    var latitud = parseFloat($('.lat').html());\n    var longitud = parseFloat($('.lng').html());\n    var zoom = parseFloat($('.zoom').html());\n    var radio = 2500;\n    var categorias = [$('#id_categoria').html()];\n    console.log('lat:'+latitud);\n    console.log('lng:'+longitud);\n    console.log('zoom:'+zoom);\n    console.log('--------------------------------------------------------------------');\n\n    map = new google.maps.Map(document.getElementById('mapa'), {\n        center: {lat: latitud , lng:  longitud},\n        zoom: parseInt($('.zoom').html())\n    });\n\n    map.addListener('zoom_changed', function() {\n        $('.zoom').html(map.getZoom());\n\n        buscar_lugares(categorias, radio);\n    });\n\n    map.addListener('mousemove', function(e) {\n        $('.lat').html(e.latLng.lat);\n        $('.lng').html(e.latLng.lng);\n    });\n\n    map.addListener('bounds_changed', function(e) {\n        var bounds =map.getBounds(); \n        $('.bounds').html(bounds.b.b+' , '+bounds.b.f+'  ::  '+bounds.f.b+' , '+bounds.f.f);\n    });\n\n    infoWindow = new google.maps.InfoWindow({map: map});\n  \n\n    // Try HTML5 geolocation.\n    /*if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function(position) {\n            var pos = {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            };\n\n            map.setCenter(pos);\n\n        }, function() {\n            handleLocationError(true, infoWindow, map.getCenter());\n        });\n    } else {\n        // Browser doesn't support Geolocation\n        handleLocationError(false, infoWindow, map.getCenter());\n    }*/\n\n    buscar_lugares(categorias, radio);\n}\n\n\nfunction build_detail_from_server(place){\n    var el = '<div class=\"panel';\n    el += '\"><div class=\"panel-heading\"><h3>'+place.name;\n    el += '<button type=\"button\" place=\"'+place.google_id+'\" class=\"visitado pull-right btn btn-info\">Visitado</button>';\n    el +='</h3></div><div class=\"panel-body\">';\n    if(typeof place.imagen!== \"undefined\")\n        el += '<img class=\"img-responsive\" src=\"'+place.imagen+'\">';\n    el += '<ul class=\"list-group\">';\n    el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-home\"></i> '+place.direccion+'</li>';\n    if (typeof place.telefono !== 'undefined' )\n        el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-earphone\"></i> '+place.telefono+'</li>';\n    el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-globe\"></i> <a href=\"'+place.website+'\">website</a></li>';\n    el += '<li class=\"list-group-item\">Categorias: ';\n        el += '<ul >';\n        for (var i = 0; i < place.cats.length; i++) {\n            el += '<li><a href=\"#\" >'+place.cats[i]+'</a></li>';\n        };\n        el += '</ul>';\n    el += '</li>';\n    el += '</ul><hr>';\n    el += '</div></div>';\n    return el;\n}\n\nfunction detail_info(place_id){\n    //'ChIJN1t_tDeuEmsRUsoyG83frY4'\n    var request = {\n        placeId: place_id\n    };\n\n    service = new google.maps.places.PlacesService(map);\n    service.getDetails(request, callback);\n\n    function callback(place, status) {\n      if (status == google.maps.places.PlacesServiceStatus.OK) {\n        $('#tabs a[href=\"#detail\"]').tab('show');\n        var categorias =[];\n        var el = '<div class=\"panel\"><div class=\"panel-heading\"><h3>';\n        el += '<button type=\"button\" place=\"'+place.place_id+'\" class=\"visitado pull-right btn btn-info\">Visitado</button>';\n        el += place.name+'</h3></div><div class=\"panel-body\">';\n        if(typeof place.photos!== \"undefined\")\n            el += '<img class=\"img-responsive\" src=\"'+place.photos[0].getUrl({'maxWidth': 200, 'maxHeight': 250})+'\">';\n        el += '<ul class=\"list-group\">';\n        el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-home\"></i> '+place['formatted_address']+'</li>';\n        if (typeof place.international_phone_number !== 'undefined' )\n            el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-earphone\"></i> '+place['international_phone_number']+'</li>';\n        if (typeof place.formatted_phone_number !== 'undefined' )\n            el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-earphone\"></i> '+place['formatted_phone_number']+'</li>';\n        el += '<li class=\"list-group-item\"><i class=\"glyphicon glyphicon-globe\"></i> <a href=\"'+place['website']+'\">website</a></li>';\n        el += '<li class=\"list-group-item\">Categorias: ';\n            el += '<ul >';\n            for (var i = 0; i < place.types.length; i++) {\n                el += '<li><a href=\"#\" >'+place.types[i]+'</a></li>';\n                categorias.push(place.types[i]);\n            };\n            el += '</ul>';\n        el += '</li>';\n        el += '</ul><hr>';\n        el += '</div></div>';\n        $('#detail').html(el);\n        var img='';\n         if(typeof place.photos!== \"undefined\"){\n            img = place.photos[0].getUrl({'maxWidth': 200, 'maxHeight': 250});\n            console.log('img: '+img);\n         }\n            $.post('{{ url(\"loader\") }}/'+place.place_id,{\n                name : place.name,\n                place_id : place.place_id,\n                vecinity : place.vicinity,\n                imagen:img,\n                direccion : place.formatted_address,\n                telefono : place.formatted_phone_number,\n                categorias: categorias,\n                web : place.website,\n                _token: '{{ Session::token() }}'\n            },function(response){\n                console.log(response);\n            });\n            $('button.visitado').on('click',function(e){\n                e.preventDefault();\n                var res = confirm('Conoces este lugar?');\n                if(res){\n                    mark_place($(this).attr('place'));\n                }else{\n                    alert('viaja mas');\n                }\n            });\n      }\n    }\n}\n\nfunction buscar_lugares(categorias,radio){\n    var lat = parseFloat($('.lat').html());\n    var lng = parseFloat($('.lng').html());\n    console.log('lat: '+lat);\n    console.log('lng: '+lng);\n    console.log('categorias: ');\n    console.log(categorias);\n    console.log('radio: '+radio);\n    var service = new google.maps.places.PlacesService(map);\n        service.nearbySearch({\n          location: {lat: lat , lng: lng},\n          radius: radio,\n          type: categorias\n    }, function callback_lugares(results, status) {\n        console.log('results');\n        console.log(results);\n        console.log('status');\n        console.log(status);\n            var items = [];\n            if (status === google.maps.places.PlacesServiceStatus.OK) {\n                renderPlaces(results);\n              for (var i = 0; i < results.length; i++) {\n                items.push({\n                    'place_id':results[i].place_id,\n                    'name':results[i].name,\n                });\n              \n                createMarker(results[i]);\n\n                var url=$('#lugares').attr('base-url');\n                var token=$('#lugares').attr('token');\n                $.post(url,{\n                    name : results[i].name,\n                    place_id : results[i].place_id,\n                    vecinity : results[i].vicinity,\n                    icon : results[i].icon,\n                    _token: token,\n                    lat: results[i].geometry.location.lat(),\n                    lng: results[i].geometry.location.lng(),\n                    type:categorias\n                },function(response){\n                    console.log(response);\n                });\n\n              }\n            }\n    });\n}\n\nfunction createMarker(place) {\n    var placeLoc = place.geometry.location;\n    var marker = new google.maps.Marker({\n      map: map,\n      position: place.geometry.location,\n      place_id: place.place_id,\n      icon: place.icon\n    });\n    google.maps.event.addListener(marker, 'click', function() {\n      infoWindow.setContent(place.name);\n      infoWindow.open(map, this);\n      detail_info(place.place_id);\n    });\n}\n\nfunction handleLocationError(browserHasGeolocation, infoWindow, pos) {\n    infoWindow.setPosition(pos);\n    infoWindow.setContent(browserHasGeolocation ?\n                        'Error: The Geolocation service failed.' :\n                        'Error: Your browser doesn\\'t support geolocation.');\n}","/**\n * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.\n *\n * You are hereby granted a non-exclusive, worldwide, royalty-free license to use,\n * copy, modify, and distribute this software in source code or binary form for use\n * in connection with the web services and APIs provided by Facebook.\n *\n * As with any software that integrates with the Facebook platform, your use of\n * this software is subject to the Facebook Developer Principles and Policies\n * [http://developers.facebook.com/policy/]. This copyright notice shall be\n * included in all copies or substantial portions of the software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n/*\n  App-specific configuration for your game.\n\n  You will need to configure:\n    - the URL to the server where you are hosting the game source code.\n    - create a new App and retrieve the app ID and namespace from Facebook\n    Developer site at https://developers.facebook.com/apps\n*/\nvar server_url = \"http://169.57.152.110/fb\";\nvar appId = '1313714368710654';\nvar appNamespace = 'friendsconocesecuadormashsample';\nvar appCenterURL = '//www.facebook.com/appcenter/' + appNamespace;\n\nvar g_useFacebook = true;\nvar bombCost = 5; // coins\n\nvar defaults = {\n  puntos: 0,\n  medallas: 0\n}\n\n/*\n  Code initialization\n*/\n$( document ).ready(function() {\n\n  // Register input event listeners\n  $( document ).on( 'change', '#select_provincia', onChangeProvincia );\n\n  $( document ).on( 'change', '#select_categoria', onChangeCategoria );\n\n  $( document ).on( 'click', '.media a', onListPlaceClick );\n\n // $( document ).on( 'mousedown', '#canvas', onGameCanvasMousedown );\n\n  /*\n  FB initialization code.\n  https://developers.facebook.com/docs/javascript/reference/FB.init/\n\n  The method FB.init() is used to initialize and setup the SDK.\n\n  @status   informs the SDK that it should check the player's\n  authentication status as part of the initialization process.\n\n  @frictionlessRequests   lets players send requests to friends from an app\n  without having to click on a pop-up confirmation dialog. When sending a\n  request to a friend, a player can authorize the app to send subsequent\n  requests to the same friend without another dialog. This streamlines the\n  process of sharing with friends.\n  */\n  /*FB.init({\n    appId: appId,\n    frictionlessRequests: true,\n    status: true,\n    version: 'v2.5'\n  });\n*/\n  /*\n  Reports that the page is now usable by the user, for collecting performance\n  metrics.\n  https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setDoneLoading\n  */\n//  FB.Canvas.setDoneLoading();\n\n  /*\n  Registers the callback for inline processing of user actions\n  https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setUrlHandler\n  */\n//  FB.Canvas.setUrlHandler( urlHandler );\n\n  /*\n  Checking the authentication status is an asynchronous process which will\n  start as soon as the SDK has been initialized and will fire the two events\n  auth.authResponseChange and auth.statusChange upon completion.\n\n  By subscribing to these events, we can control what happens next in the\n  initialization process.\n  */\n//  FB.Event.subscribe('auth.authResponseChange', onAuthResponseChange);\n//  FB.Event.subscribe('auth.statusChange', onStatusChange);\n});\n"]}